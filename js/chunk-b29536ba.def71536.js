(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b29536ba"],{"13d5":function(t,e,i){"use strict";var a=i("23e7"),s=i("d58f").left,r=i("a640"),o=i("ae40"),n=r("reduce"),l=o("reduce",{1:0});a({target:"Array",proto:!0,forced:!n||!l},{reduce:function(t){return s(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},8885:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.isReady&&!t.gettingOrder?i("div",{staticClass:"row"},[i("div",{staticClass:"col-12 mt-3"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-12 flex-x-between mb-3"},[i("div",{staticClass:"flex-align-center"},[i("el-button",{directives:[{name:"ripple",rawName:"v-ripple.400",modifiers:{400:!0}}],staticClass:"no-width flat",attrs:{type:"primary",circle:""},on:{click:function(e){return t.$router.go(-1)}}},[i("i",{staticClass:"bx bx-left-arrow-alt"})]),i("h5",{staticClass:"my-0 mr-2 ml-2"},[t._v(t._s(t.order.date))])],1),i("div",{staticClass:"flex-align-center flex-end"},[t.startEditing&&!t.gettingOrder?i("el-button",{directives:[{name:"ripple",rawName:"v-ripple.400",modifiers:{400:!0}}],staticClass:"flat",attrs:{type:"primary"},on:{click:t.discardEditingOrder}},[t._v(" Discard ")]):t._e(),t.startEditing&&!t.gettingOrder?i("el-button",{directives:[{name:"ripple",rawName:"v-ripple.400",modifiers:{400:!0}}],attrs:{disabled:!t.startEditing,loading:t.saving,type:"primary"},on:{click:t.Put}},[t._v(" Save ")]):t._e(),i("el-button",{directives:[{name:"ripple",rawName:"v-ripple.400",modifiers:{400:!0}}],attrs:{loading:t.removing,type:"danger"},on:{click:t.Remove}},[t._v(" Remove ")])],1)]),i("div",{staticClass:"col-lg-8 pr-lg-0"},[i("div",{staticClass:"box"},[i("div",{staticClass:"flex-x-between"},[i("p",{staticClass:"mt-0 mb-2 text-bold"},[t._v("Items")]),i("div",{staticClass:"d-flex align-items-center"},[i("p",{staticClass:"mt-0 pointer primary hover-underline",on:{click:t.addItem}},[i("i",{staticClass:"bx bx-plus mr-1"}),t._v("Add item ")])])]),i("div",{staticClass:"row"},[t.order.products.length>0?i("div",{staticClass:"col-12"},[i("el-collapse",t._l(t.order.products,(function(e,a){return i("el-collapse-item",{key:a,attrs:{name:a}},[i("template",{slot:"title"},[i("div",{staticClass:"flex-x-between w-100 collapse-header"},[i("p",[t._v(t._s(e.name)+" - "+t._s(e.subtotal)+"Ks")]),i("p",{staticClass:"danger hover-underline",staticStyle:{"margin-right":"8px","z-index":"10",display:"none"},on:{click:function(e){return t.removeProduct(a)}}},[i("i",{staticClass:"bx bx-x"})])])]),i("div",{staticClass:"row mb-3"},[i("div",{staticClass:"col-12 mb-3"},[i("label",{staticClass:"custom-label",attrs:{for:"Media"}},[t._v("Media")]),i("file",{key:a+e.name,attrs:{initialData:e.image?[{image:e.image}]:[]},on:{completed:function(e){return t.setImage(e,a)}}})],1),e.sale?i("div",{staticClass:"col-12 flex-align-center mb-3"},[i("div",[i("label",{staticClass:"custom-label",attrs:{for:"Name"}},[t._v("Customer")]),i("p",{staticClass:"primary pointer hover-underline",on:{click:function(i){return t.$router.push({name:"Edit order",params:{id:e.sale}})}}},[t._v(" "+t._s(e.customer_name)+" ")])])]):t._e(),i("div",{staticClass:"col-6 mb-3"},[i("label",{staticClass:"custom-label",attrs:{for:"Name"}},[t._v("Name")]),i("el-input",{staticClass:"w-100",attrs:{name:"Name"},model:{value:e.name,callback:function(i){t.$set(e,"name",i)},expression:"product.name"}})],1),i("div",{staticClass:"col-6 mb-3"},[i("label",{staticClass:"custom-label",attrs:{for:"Link"}},[t._v("Link")]),i("el-input",{staticClass:"w-100",attrs:{name:"Link"},model:{value:e.link,callback:function(i){t.$set(e,"link",i)},expression:"product.link"}})],1),i("div",{staticClass:"col-6"},[i("label",{staticClass:"custom-label",attrs:{for:"Link"}},[t._v("Quantity")]),i("el-input-number",{staticClass:"w-100",attrs:{min:0,"controls-position":"right"},on:{change:function(e){return t.changeQuantity(a)}},model:{value:e.quantity,callback:function(i){t.$set(e,"quantity",i)},expression:"product.quantity"}})],1),i("div",{staticClass:"col-6"},[i("label",{staticClass:"custom-label",attrs:{for:"Link"}},[t._v("Price")]),i("el-input",{staticClass:"w-100",attrs:{type:"number"},on:{change:function(e){return t.changeQuantity(a)}},model:{value:e.price,callback:function(i){t.$set(e,"price",i)},expression:"product.price"}})],1)])],2)})),1)],1):i("el-empty",{staticClass:"w-100",attrs:{description:"No item found!"},scopedSlots:t._u([{key:"image",fn:function(){return[i("empty")]},proxy:!0}],null,!1,81314202)})],1)]),i("div",{staticClass:"box mt-base"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-12"},[i("p",{staticClass:"mt-0 mb-2 text-bold"},[t._v("Pricing")]),i("div",{staticClass:"flex-x-between"},[i("p",{},[t._v("Total")]),i("p",{},[t._v(" "+t._s(0===parseInt(t.order.total)?"-":t.order.total)+" ")])])])])])]),i("div",{staticClass:"col-lg-4"},[i("div",{staticClass:"box"},[i("label",{staticClass:"custom-label md-text",attrs:{for:""}},[t._v("Date of order(sync from date)")]),i("el-date-picker",{staticClass:"w-100 mb-3",attrs:{disabled:"",type:"date",format:"dd/MM/yyyy","value-format":"dd/MM/yyyy",placeholder:"Pick a date"},model:{value:t.order.date,callback:function(e){t.$set(t.order,"date",e)},expression:"order.date"}}),i("label",{staticClass:"custom-label md-text",attrs:{for:""}},[t._v("Supplier")]),i("el-select",{staticClass:"w-100 mb-3",attrs:{filterable:"",remote:"","allow-create":"","reserve-keyword":"",placeholder:"Select or create new","remote-method":t.getSuppliers,loading:t.loadingSupplier},on:{change:t.changeSupplier},model:{value:t.order.supplier_name,callback:function(e){t.$set(t.order,"supplier_name",e)},expression:"order.supplier_name"}},t._l(t.suppliers,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.name}})})),1),i("label",{staticClass:"custom-label mb-0"},[t._v("Order Link")]),i("div",{staticClass:"flex-x-between mb-2"},[i("el-input",{staticClass:"mr-2",attrs:{id:"orderLink",disabled:""},model:{value:t.linkUrl,callback:function(e){t.linkUrl=e},expression:"linkUrl"}}),i("el-button",{staticClass:"flat no-width",attrs:{type:"primary"},on:{click:t.copyURL}},[t._v("Copy")]),i("el-button",{staticClass:"ml-2 no-width",attrs:{type:"primary"},on:{click:t.openUrl}},[t._v("Open Link")])],1),i("label",{staticClass:"custom-label mb-0"},[t._v("Note")]),i("el-input",{attrs:{type:"textarea",placeholder:"Text such as facebook profile link, etc.",row:5},model:{value:t.order.note,callback:function(e){t.$set(t.order,"note",e)},expression:"order.note"}})],1)])])])]):t._e()},s=[],r=(i("99af"),i("4de4"),i("13d5"),i("a434"),i("b0c0"),i("5530")),o=i("2f62"),n=i("9c83"),l=i("d50a"),c={data:function(){return{url:n["c"],isCopied:!1,linkUrl:"",openCustomProduct:!1,mediaUrl:n["b"],openFulfillDialog:!1,addingFulfill:!1,openPayment:!1,payment:{amount:"0",date:"",order_id:null},suppliers:[],loadingSupplier:!1,saving:!1,gettingOrder:!1,order:{products:[]},selectedCustomer:{},loading:null,startEditing:!1,adding:!1,due_amount:0,query:"",removing:!1}},components:{file:l["d"],empty:l["c"]},watch:{order:{handler:function(){this.startEditing=!0},deep:!0},locations:{handler:function(t){this.order.location=t[0].id,this.order.location_name=t[0].name},deep:!0}},mounted:function(){this.$store.commit("setIsReady",!1),this.filterorder()},beforeMount:function(){var t=this;window.addEventListener("beforeunload",this.preventNav),this.$once("hook:beforeDestroy",(function(){window.removeEventListener("beforeunload",t.preventNav)}))},beforeRouteLeave:function(t,e,i){this.startEditing?this.$smalltalk.confirm("Question","Do you really want to leave? you have unsaved changes!").then((function(){i()})).catch((function(){i(!1)})):i()},methods:{preventNav:function(t){this.startEditing&&(t.preventDefault(),t.returnValue="")},setImage:function(t,e){t.length>0&&(this.order.products[e].image=t[0].image)},openUrl:function(){window.open(this.linkUrl,"_blank").focus()},copyURL:function(){navigator.clipboard.writeText(this.linkUrl),this.isCopied=!0,this.$noti.display({color:"success",message:"Copied to clipboard!"})},addItem:function(){this.order.products.push({name:"",quantity:"1",price:"0",image:"/media/default.png",subtotal:"0",link:""}),this.calcTotal()},removeProduct:function(t){this.order.products.splice(t,1),this.calcTotal()},getSuppliers:function(t){var e=this;this.loadingSupplier=!0,""!==t&&t||(t="Null"),this.$axios.get("search-suppliers/?query="+t).then((function(t){e.loadingSupplier=!1,e.suppliers=t.data})).catch((function(t){e.loadingSupplier=!1,e.$noti.display({message:t,title:"",status:"error",color:"error"})}))},changeSupplier:function(){var t=this,e=this.suppliers.filter((function(e){return e.name==t.order.supplier_name}));e.length>0&&(this.selectedSupplier=e[0])},calcTotal:function(){this.order.total=this.order.products.reduce((function(t,e){return t+parseInt(e.subtotal)}),0)},changeQuantity:function(t){this.order.products[t].subtotal=parseInt(this.order.products[t].price)*parseInt(this.order.products[t].quantity),this.calcTotal()},Remove:function(){var t=this;this.removing=!0,this.$axios.delete("order/?oid="+this.order.id).then((function(){t.$noti.display({title:"Success",color:"success",message:"Cool! order has been successfully removed."}),t.$router.push({name:"imports"})})).catch((function(e){t.removing=!1,t.$noti.display({message:e,title:"",status:"error",color:"error"})}))},filterorder:function(){var t=this;this.gettingOrder=!0,this.$axios.get("order/?oid="+this.$route.params.id).then((function(e){t.order=e.data,t.orderBeforeEdit=JSON.stringify(t.order),setTimeout((function(){t.startEditing=!1,t.gettingOrder=!1}),1),t.linkUrl="http://app-order.osassist.epizy.com/?sid=".concat(t.store.id,"&oid=").concat(e.data.id,"&date=").concat(e.data.date),t.$store.commit("setIsReady",!0)})).catch((function(e){t.$noti.display({message:e,status:"error",color:"error"})}))},Put:function(){var t=this;this.saving=!0,this.order.store=this.store.id,this.$axios.put("order/",{data:this.order}).then((function(e){t.order=e.data,t.orderBeforeEdit=JSON.stringify(t.order),setTimeout((function(){t.startEditing=!1,t.adding=!1,t.saving=!1}),100),t.$noti.display({title:"Success",color:"success",message:"Cool! order has been successfully updated."})})).catch((function(e){t.saving=!1,t.$noti.display({message:e,title:"",status:"error",color:"error"})}))},discardEditingOrder:function(){var t=this;this.order=JSON.parse(this.orderBeforeEdit),setTimeout((function(){t.startEditing=!1}),10)}},computed:Object(r["a"])({},Object(o["c"])(["isReady","store"]))},d=c,u=(i("cb36"),i("2877")),p=Object(u["a"])(d,a,s,!1,null,null,null);e["default"]=p.exports},cb36:function(t,e,i){"use strict";var a=i("ce9d"),s=i.n(a);s.a},ce9d:function(t,e,i){},d58f:function(t,e,i){var a=i("1c0b"),s=i("7b0b"),r=i("44ad"),o=i("50c4"),n=function(t){return function(e,i,n,l){a(i);var c=s(e),d=r(c),u=o(c.length),p=t?u-1:0,m=t?-1:1;if(n<2)while(1){if(p in d){l=d[p],p+=m;break}if(p+=m,t?p<0:u<=p)throw TypeError("Reduce of empty array with no initial value")}for(;t?p>=0:u>p;p+=m)p in d&&(l=i(l,d[p],p,c));return l}};t.exports={left:n(!1),right:n(!0)}}}]);
//# sourceMappingURL=chunk-b29536ba.def71536.js.map