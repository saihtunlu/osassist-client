(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d207d74"],{a1f4:function(s,t,a){"use strict";a.r(t);var e=function(){var s=this,t=s._self._c;return t("div",{staticClass:"row"},[s.isReady&&s.userData.avatar?t("div",{staticClass:"col-12 mt-3"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 flex-x-between mb-3"},[t("div",{staticClass:"flex-align-center"},[t("el-button",{directives:[{name:"ripple",rawName:"v-ripple.400",modifiers:{400:!0}}],staticClass:"no-width flat",attrs:{type:"primary",circle:""},on:{click:function(t){return s.$router.go(-1)}}},[t("i",{staticClass:"bx bx-left-arrow-alt"})]),t("h5",{staticClass:"my-0 ml-2"},[s._v("My account")])],1),t("div",{staticClass:"flex-align-center flex-end"},[s.isReady&&s.startEditing?t("el-button",{directives:[{name:"ripple",rawName:"v-ripple.400",modifiers:{400:!0}}],staticClass:"flat",attrs:{type:"primary"},on:{click:s.cancelEdit}},[t("i",{staticClass:"bx bx-x mr-1"}),s._v(" Discard ")]):s._e(),s.isReady&&s.startEditing?t("el-button",{directives:[{name:"ripple",rawName:"v-ripple.400",modifiers:{400:!0}}],attrs:{disabled:!s.startEditing,loading:s.saving,type:"primary"},on:{click:s.Post}},[t("i",{staticClass:"bx bx-save mr-1"}),s._v(" Save ")]):s._e()],1)]),t("div",{staticClass:"col-lg-8"},[t("div",{staticClass:"box"},[t("div",{staticClass:"flex-x-between"},[t("p",{staticClass:"mt-0 mb-2 text-bold"},[s._v("Details")]),t("p",{staticClass:"hover-underline primary",on:{click:function(t){s.active=!0,s.type="Password"}}},[t("i",{staticClass:"bx bx-lock-alt mr-1"}),s._v(" Change password ")])]),t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 mb-3"},[t("label",{staticClass:"custom-label",attrs:{for:""}},[s._v("Avatar")]),t("file",{attrs:{initialData:s.userData.avatar?[{image:s.userData.avatar}]:[]},on:{completed:s.setImage}})],1),t("div",{staticClass:"col-6"},[t("label",{staticClass:"custom-label",attrs:{for:"name"}},[s._v("First Name")]),t("el-input",{staticClass:"w-100 mb-3",attrs:{name:"name "},model:{value:s.userData.first_name,callback:function(t){s.$set(s.userData,"first_name",t)},expression:"userData.first_name"}})],1),t("div",{staticClass:"col-6"},[t("label",{staticClass:"custom-label",attrs:{for:"name"}},[s._v("Last Name")]),t("el-input",{staticClass:"w-100 mb-3",attrs:{name:"name "},model:{value:s.userData.last_name,callback:function(t){s.$set(s.userData,"last_name",t)},expression:"userData.last_name"}})],1),t("div",{staticClass:"col-12"},[t("label",{staticClass:"custom-label",attrs:{for:"email"}},[s._v("Email Address")]),t("el-input",{staticClass:"w-100 mb-3 disabled",attrs:{name:"email "},model:{value:s.userData.email,callback:function(t){s.$set(s.userData,"email",t)},expression:"userData.email"}})],1)])])])])]):s._e(),t("el-dialog",{staticClass:"default-dialog",attrs:{"show-close":!1,visible:s.active},on:{"update:visible":function(t){s.active=t}},scopedSlots:s._u([{key:"title",fn:function(){return[t("div",{staticClass:"d-flex align-items-center justify-content-between"},[t("h5",{staticClass:"my-0"},[s._v("Changing "+s._s(s.type))]),t("div",{staticClass:"d-flex align-items-center"})])]},proxy:!0},{key:"footer",fn:function(){return[t("div",{staticClass:"d-flex align-items-center justify-content-end"},[t("el-button",{directives:[{name:"ripple",rawName:"v-ripple.400",modifiers:{400:!0}}],staticClass:"my-0 flat mr-0",attrs:{type:"primary"},on:{click:function(t){s.active=!1}}},[s._v(" Cancel ")]),t("el-button",{directives:[{name:"ripple",rawName:"v-ripple.400",modifiers:{400:!0}}],staticClass:"my-0 mr-0",attrs:{type:"primary",loading:s.confirming},on:{click:s.confirm}},[s._v(" Done ")])],1)]},proxy:!0}])},[t("div",{staticClass:"con-content"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 mb-2"},["Email"===s.type?t("div",{staticClass:"w-100"},[t("label",{staticClass:"custom-label",attrs:{for:"email"}},[s._v("Email Address")]),t("el-input",{staticClass:"w-100 mb-3",attrs:{name:"email "},model:{value:s.userData.email,callback:function(t){s.$set(s.userData,"email",t)},expression:"userData.email"}})],1):s._e(),"Password"===s.type?t("div",{staticClass:"w-100"},[t("label",{staticClass:"custom-label",attrs:{for:"Old Password"}},[s._v("Old Password")]),t("el-input",{staticClass:"w-100 mb-3",attrs:{name:"Old Password ",label:"Old Password",type:"password"},model:{value:s.old_password,callback:function(t){s.old_password=t},expression:"old_password"}}),t("label",{staticClass:"custom-label",attrs:{for:"New Password"}},[s._v("New Password")]),t("el-input",{staticClass:"w-100 mb-3",attrs:{name:"New Password ",type:"password"},model:{value:s.password,callback:function(t){s.password=t},expression:"password"}}),t("label",{staticClass:"custom-label",attrs:{for:"New Password Confirmation"}},[s._v("New Password Confirmation")]),t("el-input",{staticClass:"w-100 mb-3",attrs:{name:"New Password Confirmation ",label:"New Password Confirmation",type:"password"},model:{value:s.password_confirm,callback:function(t){s.password_confirm=t},expression:"password_confirm"}})],1):s._e()])])])])],1)},i=[],r=a("2f62"),l=a("9c83"),o=a("d50a"),n={data(){return{url:l["c"],active:!1,type:"Email",userData:{avatar:""},saving:!1,startEditing:!1,confirming:!1,old_password:"",password:"",password_confirm:""}},components:{file:o["c"]},watch:{user(s){s&&(this.setUser(),this.$store.commit("setIsReady",!0))},userData:{handler:function(){this.startEditing=!0},deep:!0}},mounted(){this.user&&(this.setUser(),this.$store.commit("setIsReady",!0))},computed:{...Object(r["c"])(["user","store","isReady"]),...Object(r["b"])(["checkIsReady"])},beforeMount(){window.addEventListener("beforeunload",this.preventNav),this.$once("hook:beforeDestroy",()=>{window.removeEventListener("beforeunload",this.preventNav)})},beforeRouteLeave(s,t,a){this.startEditing?this.$smalltalk.confirm("Question","Do you really want to leave? you have unsaved changes!").then(()=>{a()}).catch(()=>{a(!1)}):a()},methods:{preventNav(s){this.startEditing&&(s.preventDefault(),s.returnValue="")},setUser(){this.userBeforeEdit=JSON.stringify(this.user),this.userData=this.user,setTimeout(()=>{this.startEditing=!1},10)},setImage(s){s.length>0?this.userData.avatar=s[0].image:this.userData.avatar="/media/default.png"},cancelEdit(){this.userData=JSON.parse(this.userBeforeEdit),setTimeout(()=>{this.startEditing=!1},10)},Post(){this.saving=!0,this.userData.username=this.userData.first_name.replace(/\s+/g,"_").toLowerCase()+"_"+this.userData.last_name.replace(/\s+/g,"_").toLowerCase(),this.$axios.put("auth/",{data:this.userData}).then(s=>{this.$store.commit("setUser",s.data),this.userBeforeEdit=JSON.stringify(s.data),this.saving=!1,this.$noti.display({color:"success",title:"Success",message:"Cool! You profile has been successfully updated."}),setTimeout(()=>{this.startEditing=!1},100)}).catch(s=>{this.saving=!1,this.$noti.display({message:s,status:"error",color:"error"})})},confirm(){this.confirming=!0,"Email"===this.type&&this.$axios.post("change-email/",{email:this.userData.email}).then(()=>{this.confirming=!1,this.active=!1,this.$noti.display({color:"success",title:"Success",message:"The email comfimation message is sent to your email, please check your email!"})}).catch(s=>{this.confirming=!1,this.active=!1,this.$noti.display({message:s,status:"error",color:"error"})}),"Password"===this.type&&this.$axios.put("change-password/",{old_password:this.old_password,password:this.password,password_confirm:this.password_confirm}).then(()=>{this.confirming=!1,this.active=!1,this.$noti.display({color:"success",title:"Success",message:"Changing password success!"})}).catch(s=>{this.confirming=!1,this.active=!1,this.$noti.display({message:s,status:"error",color:"error"})})}}},c=n,d=a("2877"),m=Object(d["a"])(c,e,i,!1,null,null,null);t["default"]=m.exports}}]);
//# sourceMappingURL=chunk-2d207d74.7d76bea2.js.map